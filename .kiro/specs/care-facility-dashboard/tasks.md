# 介護施設向けダッシュボード - 実装タスクリスト

## 実装計画

このタスクリストは、介護施設向けダッシュボードを段階的に実装するための具体的なコーディングタスクです。各タスクは前のタスクの成果物を基に構築され、テスト駆動開発のアプローチを採用しています。

- [x] 1. プロジェクト基盤とコア型定義の実装
  - TypeScript型定義ファイルの作成（User、Staff、DashboardCard、ChatMessage等）
  - MasterCSSカスタムデザイントークンの拡張設定
  - 基本的なユーティリティ関数の実装（日付処理、バリデーション、フォーマッター）
  - _要件: 1.1, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1_

- [x] 2. 基本UIコンポーネントライブラリの構築
  - [x] 2.1 基本UIコンポーネントの実装
    - Button、Modal、Card、Toggle、FormFieldコンポーネントの作成
    - MasterCSSクラスを使用したスタイリング実装
    - _要件: 5.2, 5.3, 8.3, 8.4_

  - [x] 2.2 レイアウトコンポーネントの実装
    - Sidebarコンポーネント（2段階展開対応）の作成
    - 全画面モード切り替え機能の実装
    - レスポンシブ対応とキーボードナビゲーション実装
    - _要件: 2.2, 2.4, 4.2, 8.1, 8.3, 8.4_

- [ ] 3. Svelte 5 Rune状態管理システムの実装
  - [x] 3.1 ダッシュボード状態管理の実装





    - DashboardStoreクラス（$state、$derived使用）の作成
    - カード配置・追加・削除ロジックの実装
    - 状態の永続化機能（localStorage連携）の実装
    - _要件: 1.1, 1.2, 1.3, 1.4_

  - [x] 3.2 ユーザー・職員状態管理の実装





    - UserStore、StaffStoreクラスの作成
    - データのCRUD操作ロジック実装
    - 検索・フィルタリング機能の実装
    - _要件: 2.1, 2.5, 4.1, 4.3_

- [ ] 4. ドラッグ&ドロップ機能の実装
  - [x] 4.1 ドラッグ&ドロップユーティリティの作成





    - HTML5 Drag and Drop APIのラッパー関数実装
    - タッチデバイス対応のドラッグ機能実装
    - ドロップゾーンの視覚的フィードバック機能
    - _要件: 1.2, 1.3_

  - [x] 4.2 ダッシュボードカードのドラッグ機能統合





    - DashboardCardコンポーネントにドラッグ機能追加
    - CardGridコンポーネントでのドロップ処理実装
    - カード位置の自動調整ロジック実装
    - _要件: 1.2, 1.3_

- [ ] 5. ダッシュボードページの実装
  - [x] 5.1 ダッシュボードカードコンポーネントの作成





    - DashboardCard、CardGrid、CardSelectorコンポーネント実装
    - カードタイプ別の表示ロジック実装
    - カード設定の保存・読み込み機能実装
    - _要件: 1.1, 1.2, 1.3, 1.4_

  - [x] 5.2 ホームページ（+page.svelte）の実装





    - カードグリッドレイアウトの実装
    - 編集モード切り替え機能の実装
    - カード追加・削除UI実装
    - _要件: 1.1, 1.2, 1.3, 1.4, 1.5_

- [ ] 6. 利用者管理機能の実装
  - [x] 6.1 利用者リストコンポーネントの作成





    - UserListコンポーネント（検索・フィルタ機能付き）実装
    - 利用者データの表示・ソート機能実装
    - ページネーション機能の実装
    - _要件: 2.1_

  - [ ] 6.2 利用者詳細サイドバーの実装
    - UserSidebarコンポーネント（2段階展開対応）実装
    - UserDetailコンポーネント（編集機能付き）実装
    - 医療情報・家族情報表示機能実装
    - _要件: 2.2, 2.3, 2.4, 2.5_

  - [ ] 6.3 利用者管理ページの統合
    - user/+page.svelteでリストとサイドバーの連携実装
    - データの保存・更新機能実装
    - バリデーション機能の実装
    - _要件: 2.1, 2.2, 2.5_

- [ ] 7. 職員管理機能の実装
  - [ ] 7.1 職員管理コンポーネントの作成
    - StaffListコンポーネント（利用者管理と同様のUI）実装
    - StaffDetailコンポーネント（権限管理機能付き）実装
    - StaffScheduleコンポーネント（カレンダー表示）実装
    - _要件: 4.1, 4.2, 4.3, 4.4_

  - [ ] 7.2 職員管理ページの実装
    - staff/+page.svelteの実装
    - 勤務スケジュール管理機能実装
    - 職員情報の承認フロー実装
    - _要件: 4.1, 4.2, 4.3, 4.4, 4.5_

- [ ] 8. 統計・分析機能の実装
  - [ ] 8.1 チャートコンポーネントライブラリの実装
    - StatChartコンポーネント（Chart.js連携）実装
    - DateRangePickerコンポーネント実装
    - StatCardコンポーネント（サマリー表示用）実装
    - _要件: 3.2, 3.3_

  - [ ] 8.2 統計データ処理ロジックの実装
    - 統計データの計算・集計ロジック実装
    - 期間別データフィルタリング機能実装
    - データエクスポート機能（CSV出力）実装
    - _要件: 3.2, 3.3, 3.5_

  - [ ] 8.3 統計ページの実装
    - statistics/+page.svelteの実装
    - 動的なグラフ生成機能実装
    - 統計項目の動的追加機能実装
    - _要件: 3.1, 3.2, 3.3, 3.4_

- [ ] 9. チャット機能の実装
  - [ ] 9.1 チャットコンポーネントの作成
    - ChatWindowコンポーネント実装
    - MessageListコンポーネント（仮想化対応）実装
    - MessageInputコンポーネント（ファイル添付対応）実装
    - _要件: 6.2, 6.5, 7.3_

  - [ ] 9.2 リアルタイム通信機能の実装
    - Firebase Realtime Databaseとの連携実装
    - メッセージの送受信ロジック実装
    - 通知機能（新着メッセージ）実装
    - _要件: 6.2, 6.5, 7.3_

- [ ] 10. レポート機能の実装
  - [ ] 10.1 レポート作成コンポーネントの実装
    - ReportEditorコンポーネント（テンプレート対応）実装
    - ReportListコンポーネント（検索・フィルタ機能付き）実装
    - レポートテンプレート管理機能実装
    - _要件: 6.3, 6.4, 7.2_

  - [ ] 10.2 レポート配信機能の実装
    - 家族ポータルへのレポート配信ロジック実装
    - レポートの承認ワークフロー実装
    - レポート履歴管理機能実装
    - _要件: 6.3, 6.4, 7.2, 7.4_

- [ ] 11. 設定管理機能の実装
  - [ ] 11.1 設定UIコンポーネントの作成
    - SettingsFormコンポーネント実装
    - 設定項目の動的生成機能実装
    - 設定値のバリデーション機能実装
    - _要件: 5.1, 5.2, 5.3_

  - [ ] 11.2 設定ページの実装
    - settings/+page.svelteの実装
    - 設定のリセット機能実装
    - 設定変更の即座反映機能実装
    - _要件: 5.1, 5.2, 5.3, 5.4, 5.5_

- [ ] 12. 家族ポータル機能の実装
  - [ ] 12.1 家族向けUIコンポーネントの作成
    - FamilyDashboardコンポーネント実装
    - FamilyReportViewerコンポーネント実装
    - 簡易インターフェース（利用者本人用）実装
    - _要件: 7.1, 7.2, 7.5_

  - [ ] 12.2 家族ポータルページの実装
    - family-portal/+page.svelteの実装
    - 利用者別データフィルタリング実装
    - 過去レポート検索機能実装
    - _要件: 7.1, 7.2, 7.3, 7.4_

- [ ] 13. 認証・認可システムの実装
  - [ ] 13.1 Firebase認証連携の実装
    - 認証サービスクラス実装
    - ログイン・ログアウト機能実装
    - セッション管理機能実装
    - _要件: 6.1, 7.1_

  - [ ] 13.2 権限管理システムの実装
    - ロールベースアクセス制御実装
    - ルートガード機能実装
    - 権限チェック機能実装
    - _要件: 4.3, 6.1, 7.1_

- [ ] 14. データベース連携の実装
  - [ ] 14.1 Firestore連携サービスの実装
    - データベースサービスクラス実装
    - CRUD操作の実装
    - データ同期機能実装
    - _要件: 2.5, 4.3, 4.5, 6.4_

  - [ ] 14.2 オフライン対応の実装
    - ローカルストレージ連携実装
    - オフライン時のデータキャッシュ機能実装
    - オンライン復帰時の同期機能実装
    - _要件: 8.5_

- [ ] 15. パフォーマンス最適化の実装
  - [ ] 15.1 コード分割とレイジーローディング
    - 動的インポートによるコード分割実装
    - ルートレベルでの分割実装
    - コンポーネントの遅延読み込み実装
    - _要件: 8.5_

  - [ ] 15.2 仮想化とページネーション
    - 大量データの仮想化実装
    - 無限スクロール機能実装
    - データの段階的読み込み実装
    - _要件: 2.1, 4.1_

- [ ] 16. テスト実装
  - [ ] 16.1 単体テストの作成
    - 全コンポーネントの単体テスト実装
    - ユーティリティ関数のテスト実装
    - ストアクラスのテスト実装
    - _要件: 全要件のテストカバレッジ_

  - [ ] 16.2 統合テストの作成
    - ページレベルの統合テスト実装
    - API連携テスト実装
    - ユーザーフローテスト実装
    - _要件: 1.1-1.5, 2.1-2.5, 3.1-3.5, 4.1-4.5_

- [ ] 17. アクセシビリティ対応の実装
  - [ ] 17.1 キーボードナビゲーション実装
    - 全インタラクティブ要素のキーボード対応実装
    - フォーカス管理機能実装
    - ショートカットキー機能実装
    - _要件: 8.4_

  - [ ] 17.2 スクリーンリーダー対応実装
    - ARIA属性の適切な設定実装
    - セマンティックHTMLの使用実装
    - 読み上げ順序の最適化実装
    - _要件: 8.3_

- [ ] 18. 最終統合とデプロイ準備
  - [ ] 18.1 全機能の統合テスト
    - E2Eテストの実行と修正
    - ブラウザ互換性テスト実行
    - パフォーマンステスト実行
    - _要件: 全要件の統合確認_

  - [ ] 18.2 プロダクション設定の実装
    - 環境変数設定実装
    - ビルド最適化設定実装
    - セキュリティ設定実装
    - _要件: セキュリティ・パフォーマンス要件_